
# Bridge and Torch（过桥与火把）问题

有一座只能容纳至多两人同时通过的桥。现在有 $n$ 个人需要在夜间从桥的一侧到达另一侧，他们只有一支火把。

规则如下：

1. 任何一次过桥必须携带火把；没有火把的人不能过桥。
2. 每次过桥最多两人同行，也允许单人过桥。
3. 两人同行时，行进速度由较慢者决定：若两人分别需要 $t_i,t_j$ 分钟，则两人一起过桥耗时为 $\max(t_i,t_j)$。
4. 过桥完成后，火把也随过桥者到达对岸；若还有人未过桥，则必须有人把火把带回。

给定每个人单独过桥所需的时间 $t_1, t_2, \dots, t_n$（均为正整数/正实数），求一种过桥与返回火把的安排，使得所有人都到达对岸所需的总时间最小，并给出该最小总时间。

## 经典实例

当 $n=4$，四个人分别需要 $1,2,5,10$ 分钟单独过桥。问：所有人到达对岸所需的最短总时间是多少？


## 一般解法

假设 $n$ 个人的过桥时间从小到大排序为 $t_1 \le t_2 \le \dots \le t_n$。

用 $f(i)$ 表示前 $i$ 个人过桥所需的最短时间。

- **基础情况**：
  - $n=1$: $t_1$
  - $n=2$: $t_2$
  - $n=3$: $t_1 + t_2 + t_3$

- **递推公式** ($i \ge 4$)：
  $$f(i) = \min \left\{ \begin{aligned} & f(i-1) + t_1 + t_i & \text{(策略 1：最快者单独护送)} \\ & f(i-2) + t_1 + 2t_2 + t_i & \text{(策略 2：最快两人接力护送)} \end{aligned} \right.$$

## 数学证明

我们的目标是将最慢的两人 $P_n$ 和 $P_{n-1}$（耗时 $t_n, t_{n-1}$）运送到对岸。在最优策略中，必须尽可能减少 $t_n$ 和 $t_{n-1}$ 对总时间的贡献。

可以证明，处理最慢两人的最优策略必然是以下两种之一：

### 策略 1：最快者带最慢者 (Separate Crossing)
利用最快的人 $P_1$ 充当“摆渡人”，分别运送 $P_n$ 和 $P_{n-1}$。
1. $P_1$ 带 $P_n$ 过桥 (耗时 $t_n$)
2. $P_1$ 返回 (耗时 $t_1$)
3. $P_1$ 带 $P_{n-1}$ 过桥 (耗时 $t_{n-1}$)
4. $P_1$ 返回 (耗时 $t_1$)
此时 $P_n, P_{n-1}$ 已过桥，$P_1$ 回到出发点准备运送下一批。
**这两步对总时间的边际贡献**：$2t_1 + t_n + t_{n-1}$。

### 策略 2：最快两人接力 (Together Crossing)
利用最快的两人 $P_1, P_2$ 在对岸建立“接应”，让 $P_n$ 和 $P_{n-1}$ 一起过桥，避免 $t_{n-1}$ 被计入总时间。
1. $P_1, P_2$ 过桥 (耗时 $t_2$)
2. $P_1$ 返回 (耗时 $t_1$)
3. $P_n, P_{n-1}$ 一起过桥 (耗时 $t_n$)
4. $P_2$ 返回 (耗时 $t_2$)
此时 $P_n, P_{n-1}$ 已过桥，$P_1, P_2$ 回到出发点。
**这两步对总时间的边际贡献**：$t_1 + 2t_2 + t_n$。

### 证明逻辑
对于每一步决策，我们比较这两种策略的代价：
- 如果 $2t_1 + t_{n-1} < t_1 + 2t_2$ (即 $t_1 + t_{n-1} < 2t_2$)，策略 1 更优。
- 否则，策略 2 更优。

**为什么不需要考虑其他策略？**
假设 $P_n$ 和 $P_{n-1}$ 一起过桥，耗时 $t_n$。为了不让 $P_n$ 或 $P_{n-1}$ 送回火把（那会浪费 $t_{n-1}$ 或 $t_n$ 的时间），对岸必须已经有一个人（设为 $X$）等待拿回火把。为了把 $X$ 送过去并让他回来，最经济的方法是用最快的人送他，或者他和最快的人一起去。
通过严谨的交换论证（Exchange Argument）可以证明，任何混合了中速人员陪同最慢人员的策略，都可以通过替换为 $P_1$ 或 $P_2$ 使得总时间不增加。因此动态规划只需考虑这两种转移即可涵盖所有最优情况。
